---
phase: "05-visualization-selfassessment"
plan: "02"
type: "execute"
wave: 1
depends_on: []
files_modified:
  - "src/app/assess/page.tsx"
  - "src/components/AssessmentWizard.tsx"
  - "src/lib/self-assessment.ts"
  - "src/app/api/self-assess/route.ts"
autonomous: true
user_setup: []
must_haves:
  truths:
    - "Users can input their own project data via form wizard"
    - "Users receive immediate private compliance score"
    - "Users can compare their score against public benchmarks"
    - "Assessment form is gated behind email capture"
  artifacts:
    - path: "src/app/assess/page.tsx"
      provides: "Self-assessment page route"
      exports: "Page component with wizard"
    - path: "src/components/AssessmentWizard.tsx"
      provides: "Multi-step form wizard"
      exports: "AssessmentWizard component"
    - path: "src/lib/self-assessment.ts"
      provides: "Scoring logic for user-submitted data"
      exports: "calculateSelfAssessmentScore function"
  key_links:
    - from: "src/app/assess/page.tsx"
      to: "src/components/AssessmentWizard.tsx"
      via: "import and render"
      pattern: "import.*AssessmentWizard"
    - from: "src/components/AssessmentWizard.tsx"
      to: "src/lib/self-assessment.ts"
      via: "import and call scoring function"
      pattern: "calculateSelfAssessmentScore"
---

<objective>
Build self-assessment tool allowing users to input their own project data and receive a private compliance score with benchmark comparison.

Purpose: Municipalities, contractors, and project managers want to evaluate their own projects against the same scoring methodology used for public data. This is a strong lead generation tool.
Output: Form wizard at /assess that calculates and displays private scores
</objective>

<execution_context>
@./.planning/phases/04-details-leadgen/04-03-SUMMARY.md
@./.planning/ROADMAP.md
</execution_context>

<context>
@./.planning/PROJECT.md
@./src/lib/scoring.ts
@./src/app/gated-reports/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create self-assessment scoring logic</name>
  <files>src/lib/self-assessment.ts</files>
  <action>
    Create src/lib/self-assessment.ts:
    - Define SelfAssessmentInput interface with fields:
      - projectName: string
      - agency: string (dropdown of common agencies)
      - awardType: string (grant, contract, loan, direct payment)
      - startDate: string (ISO date)
      - endDate: string (ISO date, optional)
      - environmentalReviewDate: string (optional)
      - bidSolicitationDate: string (optional)
      - lastModificationDate: string (optional)
      - totalFundingAmount: number
      - competitionType: string (competitive, sole source, follow-on)
    - Export calculateSelfAssessmentScore function
    - Apply same weighted scoring as public scoring (env 40%, competitive 35%, modification 25%)
    - Return detailed score breakdown with recommendations
  </action>
  <verify>
    npx tsc --noEmit && node -e "require('./src/lib/self-assessment.ts')"</verify>
  <done>
    SelfAssessmentInput type and calculateSelfAssessmentScore function exported
  </done>
</task>

<task type="auto">
  <name>Task 2: Create AssessmentWizard component</name>
  <files>src/components/AssessmentWizard.tsx</files>
  <action>
    Create AssessmentWizard component at src/components/AssessmentWizard.tsx:
    - Client-side component with useState for form data and current step
    - Multi-step wizard with 4 steps:
      1. Basic Info (project name, agency, award type)
      2. Timeline (start date, end date, environmental review date)
      3. Competition (competition type, bid solicitation date)
      4. Funding (total amount, last modification date)
    - Each step has back/next buttons
    - Final step shows score results
    - Show benchmark comparison (how project compares to public average)
    - Style with Tailwind, consistent with existing forms
    - Handle validation (required fields before proceeding)
  </action>
  <verify>
    npx tsc --noEmit && ls src/components/AssessmentWizard.tsx</verify>
  <done>
    AssessmentWizard renders 4-step form with score calculation
  </done>
</task>

<task type="auto">
  <name>Task 3: Create assessment page route</name>
  <files>src/app/assess/page.tsx</files>
  <action>
    Create Next.js page at src/app/assess/page.tsx:
    - Server component that checks for user session (optional, can be public)
    - Render AssessmentWizard component
    - Include page header explaining tool purpose
    - Add link to methodology page for scoring details
    - Use existing layout and styling
  </action>
  <verify>
    npm run build && curl -s http://localhost:3000/assess | head -c 200</verify>
  <done>
    /assess page renders with form wizard
  </done>
</task>

<task type="auto">
  <name>Task 4: Add navigation link and benchmark data</name>
  <files>src/app/page.tsx</files>
  <action>
    Update src/app/page.tsx header/navigation:
    - Add "Assess Your Project" link in header
    - Update hero section to mention self-assessment tool
    - Link to /assess from methodology page
  </action>
  <verify>
    npm run build && grep -q "assess" src/app/page.tsx</verify>
  <done>
    Navigation includes link to self-assessment tool
  </done>
</task>

</tasks>

<verification>
- [ ] Form wizard navigates through all 4 steps
- [ ] Score calculates correctly using weighted formula
- [ ] Benchmark comparison shows how score compares to public data
- [ ] Required fields prevent proceeding without values
- [ ] TypeScript compiles without errors
- [ ] Build succeeds
</verification>

<success_criteria>
Users can:
- Input project data through guided form wizard
- Receive immediate compliance score (0-100)
- See score breakdown by component
- Compare their score against public project benchmarks
</success_criteria>

<output>
After completion, create `.planning/phases/05-visualization-selfassessment/05-02-SUMMARY.md`
</output>
