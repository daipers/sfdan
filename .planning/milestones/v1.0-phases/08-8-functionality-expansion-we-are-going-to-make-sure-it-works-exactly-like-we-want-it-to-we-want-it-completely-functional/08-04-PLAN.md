---
phase: 08-8-functionality-expansion-we-are-going-to-make-sure-it-works-exactly-like-we-want-it-to-we-want-it-completely-functional
plan: 04
type: execute
wave: 2
depends_on: ["08-02"]
files_modified:
  - tests/e2e.spec.ts
autonomous: true
requirements: [HARD-04]

must_haves:
  truths:
    - "Explore to project detail to lead capture flow is exercised by E2E"
    - "Self-assessment results include a lead capture step in E2E"
    - "Content, newsletter, and reports entry points are covered by E2E"
  artifacts:
    - path: "tests/e2e.spec.ts"
      provides: "Priority journey regression coverage"
      contains: "Playwright"
  key_links:
    - from: "tests/e2e.spec.ts"
      to: "/projects/"
      via: "row click navigation"
      pattern: "projects"
    - from: "tests/e2e.spec.ts"
      to: "/assess"
      via: "assessment journey"
      pattern: "assess"
---

<objective>
Expand Playwright coverage to validate the priority journeys end-to-end.

Purpose: Prevent regressions across Explore, Content, Newsletter, Reports, and Self-assessment flows.
Output: E2E tests that exercise required CTAs and lead capture steps.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@tests/e2e.spec.ts
@src/app/page.tsx
@src/components/DataTable.tsx
@src/app/projects/[id]/page.tsx
@src/app/assess/page.tsx
@src/components/AssessmentWizard.tsx
@src/components/LeadCaptureCard.tsx
@src/components/EmailGateForm.tsx
@src/app/content/page.tsx
@src/app/newsletter/page.tsx
@src/app/gated-reports/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Add E2E coverage for all priority journeys</name>
  <files>tests/e2e.spec.ts</files>
  <action>
Extend Playwright tests to cover the full priority journeys:
- Explore → Detail → Lead capture: visit `/`, click the first data table row if present, assert the URL includes `/projects/`, and verify either a lead capture CTA link to `/gated-reports` or an EmailGateForm is visible (accept either to match the LeadCaptureCard implementation). If no rows exist, skip with a clear note.
- Self-assessment → Results → Lead capture: visit `/assess`. If unauthenticated and the email gate is shown, assert the gate is visible and skip the results flow. If authenticated, complete required fields, advance through steps, reach results, and assert the lead capture CTA/email gate is present.
- Content → Newsletter: visit `/content`, assert the primary CTA links to `/newsletter`, then verify `/newsletter` renders and its primary signup CTA is visible.
- Reports: visit `/gated-reports` and assert the email gate is shown for unauthenticated users.
Keep tests resilient to empty datasets and avoid brittle text matching when possible (prefer role-based locators and URL checks).
  </action>
  <verify>npm run test:e2e</verify>
  <done>E2E tests cover explore/detail/lead capture and assessment/results/lead capture journeys along with content/newsletter/reports entry points.</done>
</task>

</tasks>

<verification>
- `npm run test:e2e` passes with updated journey tests
</verification>

<success_criteria>
- Priority journey routes and CTAs are covered by Playwright tests
- Tests are resilient to empty data and unauthenticated assessment state
</success_criteria>

<output>
After completion, create `.planning/phases/08-8-functionality-expansion-we-are-going-to-make-sure-it-works-exactly-like-we-want-it-to-we-want-it-completely-functional/08-04-SUMMARY.md`
</output>
